# VISS - MANAGER
Support repository for josesnchz/WAII. (Repository that implements authorization, authentification and other security concepts to w3c/automotive-viss2).
This repository consists on a HTML Web application using javascript and golang that can be used to make AGT, AT and Data Requests.
The future configuration API for AGT and AT (still on implementation phase) will also be here.

## Prerequisites and building
GO version 1.17 is required, since some modules related to crypto are written in go, then compiled to WASM.
Since module compilation is required, a script that automatically compiles all modules is given.
TLS communication between the web app and VISS servers must be used, although it is not already being used. It will be supported and implemented in future versions.

A script is (will be) provided to automatically build the files provided and run the webserver. After using the script, client can be used visiting localhost:8080 in any browser supporting localStorage because Keys Generated and Tokens received are stored in the browser.
```bash
# compile files and start the webserver
$./viss-manager run
# stop the webserver
$./viss-manager stop
```

The client implements dynamic selection for the purpose of the AT request and the path of the VISS data request. Both of them depends on these files:
```bash
specs/purposelist.json
specs/vsspathlist.json
```
Purpose list is generated by the ecosystem manager, and it is used by the AT Server to provide Access Tokens depending on the AGT claims.
VSS Path list is generated by the being read by VISSv2 server at startup, and it contains the data tree of the system.
Both of them are imported from the <a href="https://github.com/w3c/automotive-viss2">w3c/automotive-viss2</a> repository. 
New files can be generated following the rules specified in that repository.

Although it is possible to start the system automatically using the script provided, modules can be compiled separately and launched manually.
Go module must be compiled using GOARCH="wasm" and GOOS = "js". The main go implementation is in the file "scripts/go/gofuncs.go", which must be compiled to "scripts/go/golib.wasm".
```bash
$ GOARCH="wasm" GOOS="js" go build -o scripts/go/golib.wasm scripts/go/gofuncs.go
```
A very basic file server is required to run the web app. File server.go is provided for that purpose. It can be run using go.
```bash
$ go run server.go
```



After doing that, the web app will be avaliable in http://localhost:8080
